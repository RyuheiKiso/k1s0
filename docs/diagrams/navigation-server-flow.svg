<svg xmlns="http://www.w3.org/2000/svg" width="600" height="490" viewBox="0 0 600 490">
  <defs>
    <marker id="arr" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#555"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="300" y="32" text-anchor="middle" font-family="Helvetica,Arial,sans-serif" font-size="16" font-weight="bold" fill="#333">Navigation サーバー処理フロー</text>

  <!-- Step 1: リクエスト受信 (blue) -->
  <rect x="150" y="58" width="300" height="56" rx="8" fill="#dae8fc" stroke="#6c8ebf" stroke-width="1.5"/>
  <text x="300" y="81" text-anchor="middle" font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="bold" fill="#333">GET /api/v1/navigation</text>
  <text x="300" y="100" text-anchor="middle" font-family="Helvetica,Arial,sans-serif" font-size="11" fill="#555">リクエスト受信</text>

  <!-- Arrow 1 -->
  <line x1="300" y1="114" x2="300" y2="158" stroke="#555" stroke-width="1.5" marker-end="url(#arr)"/>

  <!-- Step 2: YAML 読み込み (green) -->
  <rect x="150" y="160" width="300" height="60" rx="8" fill="#d5e8d4" stroke="#82b366" stroke-width="1.5"/>
  <text x="300" y="185" text-anchor="middle" font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="bold" fill="#333">navigation.yaml を読み込む</text>
  <text x="300" y="205" text-anchor="middle" font-family="Helvetica,Arial,sans-serif" font-size="10" fill="#777">（起動時にキャッシュ済み）</text>

  <!-- Arrow 2 -->
  <line x1="300" y1="220" x2="300" y2="264" stroke="#555" stroke-width="1.5" marker-end="url(#arr)"/>

  <!-- Step 3: ロールフィルタ (yellow) -->
  <rect x="150" y="266" width="300" height="60" rx="8" fill="#fff2cc" stroke="#d6b656" stroke-width="1.5"/>
  <text x="300" y="289" text-anchor="middle" font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="bold" fill="#333">ユーザーロールでフィルタリング</text>
  <text x="300" y="309" text-anchor="middle" font-family="Helvetica,Arial,sans-serif" font-size="10" fill="#777">（オプション・Phase 10）</text>

  <!-- Arrow 3 -->
  <line x1="300" y1="326" x2="300" y2="370" stroke="#555" stroke-width="1.5" marker-end="url(#arr)"/>

  <!-- Step 4: レスポンス返却 (purple) -->
  <rect x="150" y="372" width="300" height="56" rx="8" fill="#e1d5e7" stroke="#9673a6" stroke-width="1.5"/>
  <text x="300" y="395" text-anchor="middle" font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="bold" fill="#333">NavigationResponse を返す</text>
  <text x="300" y="415" text-anchor="middle" font-family="Helvetica,Arial,sans-serif" font-size="11" fill="#555">JSON（proto スキーマ準拠）</text>

  <!-- Step numbers on left -->
  <circle cx="122" cy="86" r="14" fill="#6c8ebf"/>
  <text x="122" y="91" text-anchor="middle" font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="bold" fill="white">1</text>
  <circle cx="122" cy="190" r="14" fill="#82b366"/>
  <text x="122" y="195" text-anchor="middle" font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="bold" fill="white">2</text>
  <circle cx="122" cy="296" r="14" fill="#d6b656"/>
  <text x="122" y="301" text-anchor="middle" font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="bold" fill="white">3</text>
  <circle cx="122" cy="400" r="14" fill="#9673a6"/>
  <text x="122" y="405" text-anchor="middle" font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="bold" fill="white">4</text>
</svg>

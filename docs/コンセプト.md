# コンセプト

k1s0（キソ）は、CLIツール一つでプロジェクトの構築から運用までを完結させるための開発基盤です。

## ターゲット

企業のシステム開発部門を対象とします。

## ミッション

| 目標                       | 概要                                                             |
| -------------------------- | ---------------------------------------------------------------- |
| 開発工数の削減             | ひな形生成と自動化により、初期構築・運用の手間を最小化する       |
| 新技術の採用ハードルの低下 | ベストプラクティスを組み込んだテンプレートで、学習コストを抑える |
| システムの柔軟性の向上     | マイクロサービス構成を前提とし、サービスの追加・変更を容易にする |
| 可観測性の向上             | トレース・メトリクス・ログを初期構成に含め、運用品質を底上げする |

## バリュー

- **ワンストップ** — ひな形生成・ビルド・テスト・デプロイをCLI一つで完結
- **ベストプラクティスの内蔵** — クリーンアーキテクチャ・DDD・TDDに沿ったコードを最初から生成
- **可観測性のゼロコンフィグ** — OpenTelemetry・ログ・メトリクスを初期構成に組み込み済み
- **技術選定の簡素化** — 用途に応じた通信方式（REST / gRPC / GraphQL）やインフラ構成を対話的に選択

## 技術スタック

### 設計思想

| 設計思想                       | 適用範囲                           |
| ------------------------------ | ---------------------------------- |
| クリーンアーキテクチャ         | レイヤー分離とテスタビリティの確保 |
| ドメイン駆動設計（DDD）        | ドメインモデルを中心とした設計     |
| テスト駆動開発（TDD）          | テストファーストによる品質担保     |
| マイクロサービスアーキテクチャ | サービス単位の独立デプロイ         |
| イベント駆動アーキテクチャ     | サービス間の疎結合な連携           |

### 設計パターン

| パターン           | 用途                             |
| ------------------ | -------------------------------- |
| CQRS               | コマンドとクエリの責務分離       |
| イベントソーシング | 状態変更をイベントとして永続化   |
| Saga パターン      | 分散トランザクションの整合性制御 |

### API / 通信

| 技術     | 用途                                     |
| -------- | ---------------------------------------- |
| REST API | 汎用的なHTTP通信                         |
| gRPC     | サービス間の高速な内部通信               |
| GraphQL  | クライアント主導の柔軟なデータ取得       |
| OpenAPI  | REST APIのスキーマ定義・コードからの自動生成 |
| protobuf | gRPC用のインターフェース定義・シリアライズ   |

### セキュリティ

| 技術             | 用途                           |
| ---------------- | ------------------------------ |
| OAuth 2.0 / OIDC | 認証・ID連携                   |
| JWT              | トークンベースの認可           |
| HashiCorp Vault  | シークレットの一元管理・配布   |

### インフラ / CI・CD

| 技術       | 用途                             |
| ---------- | -------------------------------- |
| Docker     | コンテナによる実行環境の統一     |
| Kubernetes | コンテナオーケストレーション     |
| Helm       | Kubernetesマニフェストのテンプレート管理 |
| Terraform  | インフラのコード管理（IaC）      |
| CI/CD      | ビルド・テスト・デプロイの自動化 |

### サービスメッシュ

| 技術           | 用途                                     |
| -------------- | ---------------------------------------- |
| Istio / Envoy  | トラフィック制御・mTLS・サービス間通信管理 |

### 可観測性

| 技術          | 用途                         |
| ------------- | ---------------------------- |
| OpenTelemetry | テレメトリデータの収集・送信 |
| Jaeger        | 分散トレーシング             |
| Prometheus    | メトリクス収集               |
| Grafana       | ダッシュボード・可視化       |
| Loki          | ログ集約                     |

### メッセージング

| 技術  | 用途                             |
| ----- | -------------------------------- |
| Kafka | サービス間の非同期メッセージング |

### データストア

| 技術       | 用途                               |
| ---------- | ---------------------------------- |
| PostgreSQL | メインのリレーショナルデータベース |
| MySQL      | リレーショナルデータベース         |
| SQL Server | リレーショナルデータベース         |
| SQLite     | 軽量な組み込みデータベース         |
| Redis      | キャッシュ・セッション管理         |

### API ゲートウェイ

| 技術 | 用途                                 |
| ---- | ------------------------------------ |
| Kong | APIゲートウェイ・トラフィック制御    |

### 耐障害性

| パターン                   | 用途                     |
| -------------------------- | ------------------------ |
| Circuit Breaker            | 障害の連鎖防止           |
| Retry + Exponential Backoff | 一時的障害への自動復旧   |
| Rate Limiting              | 過負荷防止               |

### 開発者体験

| 技術          | 用途                       |
| ------------- | -------------------------- |
| Dev Container | 開発環境の統一・即時構築   |

### コード・ドキュメント自動生成

| 技術                     | 用途                                 |
| ------------------------ | ------------------------------------ |
| OpenAPI → SDK生成        | REST APIクライアントコードの自動生成 |
| protobuf → ドキュメント生成 | gRPC APIのドキュメント自動生成       |

## 設計上の制約

- アプリケーション内での環境変数の直接参照を禁止し、YAMLファイルで一元管理する
